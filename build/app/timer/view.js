define(["jquery","underscore","app/base/view","text!app/timer/style.css","text!app/timer/template.tpl","jquery.knob"],function(a,b,c,d,e){"use strict";function f(){this.elementId="#timer",this.timer=new g}function g(a){var b=a||{};this.frame=b.frame||60,this.remaining=this.frame}return f.prototype=b.extend(new c(d,e),{render:function(){this.renderTemplate({secs:this.getSecs()}),this.renderDial()},renderDial:function(){a(this.elementId).find("input").knob({readOnly:!0,width:120,height:120,min:0,max:60,inputColor:"#fff",bgColor:"#6c6",fgColor:"#666",thickness:".30",rotation:"anticlockwise"})},getSecs:function(){var a=this.timer.remaining;return 10>a?"0"+a:a},start:function(a){var c=this,d=a||{};this.timer.start({onTick:function(){c.render(),0===c.timer.remaining&&b.isFunction(d.onStop)&&d.onStop()}})},stop:function(){this.timer.stop(),this.render()}}),g.prototype={start:function(a){var c=this;this.onTick=a.onTick||b.noop,this.timer=setInterval(function(){c.remaining--,c.onTick(),c.remaining||c.stop()},1e3)},stop:function(){this.remaining=this.frame,clearInterval(this.timer)}},f});